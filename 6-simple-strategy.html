<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Section 6 A simple inference strategy | A Ride in Targeted Learning Territory</title>
  <meta name="description" content="A ride in targeted learning territory is a gentle introduction to the filed of targeted learning. It weaves together two main threads, one theoretical and the other computational. It uses tlrider, a companion R package built specifically for this project." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Section 6 A simple inference strategy | A Ride in Targeted Learning Territory" />
  <meta property="og:type" content="book" />
  <meta property="og:image" content="/cover.jpg" />
  <meta property="og:description" content="A ride in targeted learning territory is a gentle introduction to the filed of targeted learning. It weaves together two main threads, one theoretical and the other computational. It uses tlrider, a companion R package built specifically for this project." />
  <meta name="github-repo" content="achambaz/tlride" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Section 6 A simple inference strategy | A Ride in Targeted Learning Territory" />
  
  <meta name="twitter:description" content="A ride in targeted learning territory is a gentle introduction to the filed of targeted learning. It weaves together two main threads, one theoretical and the other computational. It uses tlrider, a companion R package built specifically for this project." />
  <meta name="twitter:image" content="/cover.jpg" />

<meta name="author" content="David Benkeser (Emory University)" />
<meta name="author" content="Antoine Chambaz (Université de Paris)" />


<meta name="date" content="2022-10-20" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
<link rel="prev" href="5-inference.html"/>
<link rel="next" href="7-nuisance.html"/>
<script src="assets/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="assets/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="assets/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="assets/anchor-sections-1.1.0/anchor-sections.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
  CommonHTML: {
    scale: 90,
    linebreaks: {
      automatic: true
    }
  },
  SVG: {
    linebreaks: {
      automatic: true
    }
  }, 
  displayAlign: "left"
  });
</script>
<script type="text/javascript"
	src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async>
</script><!-- see also '_output.yaml'
src="https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"
src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML" 
src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"
-->



<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="tlride.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><strong><a href="https://achambaz.github.io/tlride/">TLRIDE</a></strong></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="part"><span><b>I On the road</b></span></li>
<li class="chapter" data-level="1" data-path="1-a-ride.html"><a href="1-a-ride.html"><i class="fa fa-check"></i><b>1</b> A ride</a>
<ul>
<li class="chapter" data-level="1.1" data-path="1-a-ride.html"><a href="1-a-ride.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="1-a-ride.html"><a href="1-a-ride.html#causal-story"><i class="fa fa-check"></i><b>1.1.1</b> A causal story</a></li>
<li class="chapter" data-level="1.1.2" data-path="1-a-ride.html"><a href="1-a-ride.html#tlrider-package"><i class="fa fa-check"></i><b>1.1.2</b> The <code>tlrider</code> package</a></li>
<li class="chapter" data-level="1.1.3" data-path="1-a-ride.html"><a href="1-a-ride.html#discuss"><i class="fa fa-check"></i><b>1.1.3</b> What we will discuss</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="1-a-ride.html"><a href="1-a-ride.html#simulation-study"><i class="fa fa-check"></i><b>1.2</b> A simulation study</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="1-a-ride.html"><a href="1-a-ride.html#reproducible-experiment"><i class="fa fa-check"></i><b>1.2.1</b> Reproducible experiment as a law</a></li>
<li class="chapter" data-level="1.2.2" data-path="1-a-ride.html"><a href="1-a-ride.html#synthetic-experiment"><i class="fa fa-check"></i><b>1.2.2</b> A synthetic reproducible experiment</a></li>
<li class="chapter" data-level="1.2.3" data-path="1-a-ride.html"><a href="1-a-ride.html#revealing-experiment"><i class="fa fa-check"></i><b>1.2.3</b> Revealing <code>experiment</code></a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="1-a-ride.html"><a href="1-a-ride.html#exo-visualization"><i class="fa fa-check"></i><b>1.3</b> ⚙ Visualization</a></li>
<li class="chapter" data-level="1.4" data-path="1-a-ride.html"><a href="1-a-ride.html#exo-make-own-experiment"><i class="fa fa-check"></i><b>1.4</b> ⚙ Make your own experiment</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="2-parameter.html"><a href="2-parameter.html"><i class="fa fa-check"></i><b>2</b> The parameter of interest</a>
<ul>
<li class="chapter" data-level="2.1" data-path="2-parameter.html"><a href="2-parameter.html#parameter-first-pass"><i class="fa fa-check"></i><b>2.1</b> The parameter of interest</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="2-parameter.html"><a href="2-parameter.html#definition"><i class="fa fa-check"></i><b>2.1.1</b> Definition</a></li>
<li class="chapter" data-level="2.1.2" data-path="2-parameter.html"><a href="2-parameter.html#causal-interpretation"><i class="fa fa-check"></i><b>2.1.2</b> A causal interpretation</a></li>
<li class="chapter" data-level="2.1.3" data-path="2-parameter.html"><a href="2-parameter.html#causal-computation"><i class="fa fa-check"></i><b>2.1.3</b> A causal computation</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="2-parameter.html"><a href="2-parameter.html#exo-alternative-parameter-first-pass"><i class="fa fa-check"></i><b>2.2</b> ⚙ An alternative parameter of interest</a></li>
<li class="chapter" data-level="2.3" data-path="2-parameter.html"><a href="2-parameter.html#parameter-second-pass"><i class="fa fa-check"></i><b>2.3</b> The statistical mapping of interest</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="2-parameter.html"><a href="2-parameter.html#opening"><i class="fa fa-check"></i><b>2.3.1</b> Opening discussion</a></li>
<li class="chapter" data-level="2.3.2" data-path="2-parameter.html"><a href="2-parameter.html#parameter-mapping"><i class="fa fa-check"></i><b>2.3.2</b> The parameter as the value of a statistical mapping at the experiment</a></li>
<li class="chapter" data-level="2.3.3" data-path="2-parameter.html"><a href="2-parameter.html#value-another-experiment"><i class="fa fa-check"></i><b>2.3.3</b> The value of the statistical mapping at another experiment</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="2-parameter.html"><a href="2-parameter.html#exo-alternative-parameter-second-pass"><i class="fa fa-check"></i><b>2.4</b> ⚙ Alternative statistical mapping</a></li>
<li class="chapter" data-level="2.5" data-path="2-parameter.html"><a href="2-parameter.html#parameter-third-pass"><i class="fa fa-check"></i><b>2.5</b> Representations</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="2-parameter.html"><a href="2-parameter.html#yet-another"><i class="fa fa-check"></i><b>2.5.1</b> Yet another representation</a></li>
<li class="chapter" data-level="2.5.2" data-path="2-parameter.html"><a href="2-parameter.html#rep-to-est"><i class="fa fa-check"></i><b>2.5.2</b> From representations to estimation strategies</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="2-parameter.html"><a href="2-parameter.html#exo-alternative-parameter-third-pass"><i class="fa fa-check"></i><b>2.6</b> ⚙ Alternative representation</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="3-smooth.html"><a href="3-smooth.html"><i class="fa fa-check"></i><b>3</b> Smoothness</a>
<ul>
<li class="chapter" data-level="3.1" data-path="3-smooth.html"><a href="3-smooth.html#smooth-first-pass"><i class="fa fa-check"></i><b>3.1</b> Fluctuating smoothly</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="3-smooth.html"><a href="3-smooth.html#fluctuations"><i class="fa fa-check"></i><b>3.1.1</b> The <code>another_experiment</code> fluctuation</a></li>
<li class="chapter" data-level="3.1.2" data-path="3-smooth.html"><a href="3-smooth.html#numerical-illus"><i class="fa fa-check"></i><b>3.1.2</b> Numerical illustration</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="3-smooth.html"><a href="3-smooth.html#exo-yet-another-experiment"><i class="fa fa-check"></i><b>3.2</b> ⚙ Yet another experiment</a></li>
<li class="chapter" data-level="3.3" data-path="3-smooth.html"><a href="3-smooth.html#smooth-second-pass"><i class="fa fa-check"></i><b>3.3</b> ☡  More on fluctuations and smoothness</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="3-smooth.html"><a href="3-smooth.html#smooth-second-pass-fluctuations"><i class="fa fa-check"></i><b>3.3.1</b> Fluctuations</a></li>
<li class="chapter" data-level="3.3.2" data-path="3-smooth.html"><a href="3-smooth.html#smoothness-and-gradients"><i class="fa fa-check"></i><b>3.3.2</b> Smoothness and gradients</a></li>
<li class="chapter" data-level="3.3.3" data-path="3-smooth.html"><a href="3-smooth.html#Euclidean-perspective"><i class="fa fa-check"></i><b>3.3.3</b> A Euclidean perspective</a></li>
<li class="chapter" data-level="3.3.4" data-path="3-smooth.html"><a href="3-smooth.html#canonical-gradient"><i class="fa fa-check"></i><b>3.3.4</b> The canonical gradient</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="3-smooth.html"><a href="3-smooth.html#revisiting"><i class="fa fa-check"></i><b>3.4</b> A fresh look at <code>another_experiment</code></a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="3-smooth.html"><a href="3-smooth.html#deriving-the-efficient-influence-curve"><i class="fa fa-check"></i><b>3.4.1</b> Deriving the efficient influence curve</a></li>
<li class="chapter" data-level="3.4.2" data-path="3-smooth.html"><a href="3-smooth.html#numerical-validation"><i class="fa fa-check"></i><b>3.4.2</b> Numerical validation</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="3-smooth.html"><a href="3-smooth.html#influence-curves"><i class="fa fa-check"></i><b>3.5</b> ☡  Asymptotic linearity and statistical efficiency</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="3-smooth.html"><a href="3-smooth.html#asymptotic-linearity"><i class="fa fa-check"></i><b>3.5.1</b> Asymptotic linearity</a></li>
<li class="chapter" data-level="3.5.2" data-path="3-smooth.html"><a href="3-smooth.html#influence-curves-and-gradients"><i class="fa fa-check"></i><b>3.5.2</b> Influence curves and gradients</a></li>
<li class="chapter" data-level="3.5.3" data-path="3-smooth.html"><a href="3-smooth.html#asymptotic-efficiency"><i class="fa fa-check"></i><b>3.5.3</b> Asymptotic efficiency</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="3-smooth.html"><a href="3-smooth.html#exo-cramer-rao"><i class="fa fa-check"></i><b>3.6</b> ⚙ Cramér-Rao bounds</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="4-double-robustness.html"><a href="4-double-robustness.html"><i class="fa fa-check"></i><b>4</b> Double-robustness</a>
<ul>
<li class="chapter" data-level="4.1" data-path="4-double-robustness.html"><a href="4-double-robustness.html#linear-approximation"><i class="fa fa-check"></i><b>4.1</b> Linear approximations of parameters</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="4-double-robustness.html"><a href="4-double-robustness.html#from-gradients-to-estimators"><i class="fa fa-check"></i><b>4.1.1</b> From gradients to estimators</a></li>
<li class="chapter" data-level="4.1.2" data-path="4-double-robustness.html"><a href="4-double-robustness.html#another-Euclidean-perspective"><i class="fa fa-check"></i><b>4.1.2</b> A Euclidean perspective</a></li>
<li class="chapter" data-level="4.1.3" data-path="4-double-robustness.html"><a href="4-double-robustness.html#the-remainder-term"><i class="fa fa-check"></i><b>4.1.3</b> The remainder term</a></li>
<li class="chapter" data-level="4.1.4" data-path="4-double-robustness.html"><a href="4-double-robustness.html#expressing-the-remainder-term-as-a-function-of-the-relevant-features"><i class="fa fa-check"></i><b>4.1.4</b> Expressing the remainder term as a function of the relevant features</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="4-double-robustness.html"><a href="4-double-robustness.html#exo-remainder-term"><i class="fa fa-check"></i><b>4.2</b> ⚙ The remainder term</a></li>
<li class="chapter" data-level="4.3" data-path="4-double-robustness.html"><a href="4-double-robustness.html#def-double-robustness"><i class="fa fa-check"></i><b>4.3</b> ☡  Double-robustness</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="4-double-robustness.html"><a href="4-double-robustness.html#the-key-property"><i class="fa fa-check"></i><b>4.3.1</b> The key property</a></li>
<li class="chapter" data-level="4.3.2" data-path="4-double-robustness.html"><a href="4-double-robustness.html#direct-consequence"><i class="fa fa-check"></i><b>4.3.2</b> Its direct consequence</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="4-double-robustness.html"><a href="4-double-robustness.html#exo-double-robustness"><i class="fa fa-check"></i><b>4.4</b> ⚙ Double-robustness</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="5-inference.html"><a href="5-inference.html"><i class="fa fa-check"></i><b>5</b> Inference</a>
<ul>
<li class="chapter" data-level="5.1" data-path="5-inference.html"><a href="5-inference.html#where-we-stand"><i class="fa fa-check"></i><b>5.1</b> Where we stand</a></li>
<li class="chapter" data-level="5.2" data-path="5-inference.html"><a href="5-inference.html#where-we-are-going"><i class="fa fa-check"></i><b>5.2</b> Where we are going</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="6-simple-strategy.html"><a href="6-simple-strategy.html"><i class="fa fa-check"></i><b>6</b> A simple inference strategy</a>
<ul>
<li class="chapter" data-level="6.1" data-path="6-simple-strategy.html"><a href="6-simple-strategy.html#a-cautionary-detour"><i class="fa fa-check"></i><b>6.1</b> A cautionary detour</a></li>
<li class="chapter" data-level="6.2" data-path="6-simple-strategy.html"><a href="6-simple-strategy.html#delta-method"><i class="fa fa-check"></i><b>6.2</b> ⚙ Delta-method</a></li>
<li class="chapter" data-level="6.3" data-path="6-simple-strategy.html"><a href="6-simple-strategy.html#known-gbar-first-pass"><i class="fa fa-check"></i><b>6.3</b> IPTW estimator assuming the mechanism of action known</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="6-simple-strategy.html"><a href="6-simple-strategy.html#a-simple-estimator"><i class="fa fa-check"></i><b>6.3.1</b> A simple estimator</a></li>
<li class="chapter" data-level="6.3.2" data-path="6-simple-strategy.html"><a href="6-simple-strategy.html#elementary-statistical-properties"><i class="fa fa-check"></i><b>6.3.2</b> Elementary statistical properties</a></li>
<li class="chapter" data-level="6.3.3" data-path="6-simple-strategy.html"><a href="6-simple-strategy.html#empirical-inves-IPTW"><i class="fa fa-check"></i><b>6.3.3</b> Empirical investigation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="7-nuisance.html"><a href="7-nuisance.html"><i class="fa fa-check"></i><b>7</b> Nuisance parameters</a>
<ul>
<li class="chapter" data-level="7.1" data-path="7-nuisance.html"><a href="7-nuisance.html#anatomy"><i class="fa fa-check"></i><b>7.1</b> Anatomy of an expression</a></li>
<li class="chapter" data-level="7.2" data-path="7-nuisance.html"><a href="7-nuisance.html#an-algorithmic-stance"><i class="fa fa-check"></i><b>7.2</b> An algorithmic stance</a></li>
<li class="chapter" data-level="7.3" data-path="7-nuisance.html"><a href="7-nuisance.html#nuisance-QW"><i class="fa fa-check"></i><b>7.3</b> <code>QW</code></a></li>
<li class="chapter" data-level="7.4" data-path="7-nuisance.html"><a href="7-nuisance.html#nuisance-Gbar"><i class="fa fa-check"></i><b>7.4</b> <code>Gbar</code></a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="7-nuisance.html"><a href="7-nuisance.html#logis-loss"><i class="fa fa-check"></i><b>7.4.1</b> Working model-based algorithms</a></li>
<li class="chapter" data-level="7.4.2" data-path="7-nuisance.html"><a href="7-nuisance.html#algo-Gbar-one"><i class="fa fa-check"></i><b>7.4.2</b> Visualization</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="7-nuisance.html"><a href="7-nuisance.html#nuisance-Qbar-wm"><i class="fa fa-check"></i><b>7.5</b> ⚙ <code>Qbar</code>, working model-based algorithms</a></li>
<li class="chapter" data-level="7.6" data-path="7-nuisance.html"><a href="7-nuisance.html#nuisance-Qbar"><i class="fa fa-check"></i><b>7.6</b> <code>Qbar</code></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="7-nuisance.html"><a href="7-nuisance.html#qbar-machine-learning-based-algorithms"><i class="fa fa-check"></i><b>7.6.1</b> <code>Qbar</code>, machine learning-based algorithms</a></li>
<li class="chapter" data-level="7.6.2" data-path="7-nuisance.html"><a href="7-nuisance.html#Qbar-knn-algo"><i class="fa fa-check"></i><b>7.6.2</b> <code>Qbar</code>, kNN algorithm</a></li>
<li class="chapter" data-level="7.6.3" data-path="7-nuisance.html"><a href="7-nuisance.html#boosted-trees"><i class="fa fa-check"></i><b>7.6.3</b> <code>Qbar</code>, boosted trees algorithm</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="7-nuisance.html"><a href="7-nuisance.html#nuisance-Qbar-ml-exo"><i class="fa fa-check"></i><b>7.7</b> ⚙ ☡  <code>Qbar</code>, machine learning-based algorithms</a></li>
<li class="chapter" data-level="7.8" data-path="7-nuisance.html"><a href="7-nuisance.html#meta-learning"><i class="fa fa-check"></i><b>7.8</b> Meta-learning/super learning</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html"><i class="fa fa-check"></i><b>8</b> Two “naive” inference strategies</a>
<ul>
<li class="chapter" data-level="8.1" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#why-naive"><i class="fa fa-check"></i><b>8.1</b> Why “naive?”</a></li>
<li class="chapter" data-level="8.2" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#known-gbar-second-pass"><i class="fa fa-check"></i><b>8.2</b> IPTW estimator</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#unknown-gbar-constr"><i class="fa fa-check"></i><b>8.2.1</b> Construction and computation</a></li>
<li class="chapter" data-level="8.2.2" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#elementary-stat-prop-iptw"><i class="fa fa-check"></i><b>8.2.2</b> Elementary statistical properties</a></li>
<li class="chapter" data-level="8.2.3" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#empirical-inves-IPTW-bis"><i class="fa fa-check"></i><b>8.2.3</b> Empirical investigation</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#exo-a-nice-title"><i class="fa fa-check"></i><b>8.3</b> ⚙ Investigating further the IPTW inference strategy</a></li>
<li class="chapter" data-level="8.4" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#Gcomp-estimator"><i class="fa fa-check"></i><b>8.4</b> G-computation estimator</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#Gcomp-construction"><i class="fa fa-check"></i><b>8.4.1</b> Construction and computation</a></li>
<li class="chapter" data-level="8.4.2" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#elementary-statistical-properties-1"><i class="fa fa-check"></i><b>8.4.2</b> Elementary statistical properties</a></li>
<li class="chapter" data-level="8.4.3" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#empirical-inves-Gcomp"><i class="fa fa-check"></i><b>8.4.3</b> Empirical investigation, fixed sample size</a></li>
<li class="chapter" data-level="8.4.4" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#empirical-inves-Gcomp-varying"><i class="fa fa-check"></i><b>8.4.4</b> ☡  Empirical investigation, varying sample size</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="8-naive-estimators.html"><a href="8-naive-estimators.html#exo-plug-in-estimate"><i class="fa fa-check"></i><b>8.5</b> ⚙ Investigating further the G-computation estimation strategy</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="9-one-step.html"><a href="9-one-step.html"><i class="fa fa-check"></i><b>9</b> One-step correction</a>
<ul>
<li class="chapter" data-level="9.1" data-path="9-one-step.html"><a href="9-one-step.html#analysis-of-plug-in"><i class="fa fa-check"></i><b>9.1</b> ☡  General analysis of plug-in estimators</a></li>
<li class="chapter" data-level="9.2" data-path="9-one-step.html"><a href="9-one-step.html#huber-one-step"><i class="fa fa-check"></i><b>9.2</b> One-step correction</a></li>
<li class="chapter" data-level="9.3" data-path="9-one-step.html"><a href="9-one-step.html#empirical-inves-one-step"><i class="fa fa-check"></i><b>9.3</b> Empirical investigation</a></li>
<li class="chapter" data-level="9.4" data-path="9-one-step.html"><a href="9-one-step.html#exo-one-step"><i class="fa fa-check"></i><b>9.4</b> ⚙ Investigating further the one-step correction methodology</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="10-TMLE.html"><a href="10-TMLE.html"><i class="fa fa-check"></i><b>10</b> Targeted minimum loss-based estimation</a>
<ul>
<li class="chapter" data-level="10.1" data-path="10-TMLE.html"><a href="10-TMLE.html#TMLE-motivations"><i class="fa fa-check"></i><b>10.1</b> Motivations</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="10-TMLE.html"><a href="10-TMLE.html#falling-outside-the-parameter-space"><i class="fa fa-check"></i><b>10.1.1</b> Falling outside the parameter space</a></li>
<li class="chapter" data-level="10.1.2" data-path="10-TMLE.html"><a href="10-TMLE.html#eic-equation"><i class="fa fa-check"></i><b>10.1.2</b> The influence curve equation</a></li>
<li class="chapter" data-level="10.1.3" data-path="10-TMLE.html"><a href="10-TMLE.html#basic-fact"><i class="fa fa-check"></i><b>10.1.3</b> A basic fact on the influence curve equation</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="10-TMLE.html"><a href="10-TMLE.html#targeted-fluctuation-TMLE"><i class="fa fa-check"></i><b>10.2</b> Targeted fluctuation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="10-TMLE.html"><a href="10-TMLE.html#fluctuating-indirectly"><i class="fa fa-check"></i><b>10.2.1</b> ☡  Fluctuating indirectly</a></li>
<li class="chapter" data-level="10.2.2" data-path="10-TMLE.html"><a href="10-TMLE.html#fluct-direct"><i class="fa fa-check"></i><b>10.2.2</b> Fluctuating directly</a></li>
<li class="chapter" data-level="10.2.3" data-path="10-TMLE.html"><a href="10-TMLE.html#exo-fluct"><i class="fa fa-check"></i><b>10.2.3</b> ⚙ More on fluctuations</a></li>
<li class="chapter" data-level="10.2.4" data-path="10-TMLE.html"><a href="10-TMLE.html#roaming"><i class="fa fa-check"></i><b>10.2.4</b> Targeted roaming of a fluctuation</a></li>
<li class="chapter" data-level="10.2.5" data-path="10-TMLE.html"><a href="10-TMLE.html#fluct-justification"><i class="fa fa-check"></i><b>10.2.5</b> Justifying the form of the fluctutation</a></li>
<li class="chapter" data-level="10.2.6" data-path="10-TMLE.html"><a href="10-TMLE.html#exo-tmle-flucs"><i class="fa fa-check"></i><b>10.2.6</b> ⚙ Alternative fluctuation</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="10-TMLE.html"><a href="10-TMLE.html#summary-and-perspectives"><i class="fa fa-check"></i><b>10.3</b> Summary and perspectives</a></li>
<li class="chapter" data-level="10.4" data-path="10-TMLE.html"><a href="10-TMLE.html#empirical-inves-tmle"><i class="fa fa-check"></i><b>10.4</b> Empirical investigation</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="10-TMLE.html"><a href="10-TMLE.html#empirical-inves-tmle-first"><i class="fa fa-check"></i><b>10.4.1</b> A first numerical application</a></li>
<li class="chapter" data-level="10.4.2" data-path="10-TMLE.html"><a href="10-TMLE.html#exo-tmle"><i class="fa fa-check"></i><b>10.4.2</b> ⚙ A computational exploration</a></li>
<li class="chapter" data-level="10.4.3" data-path="10-TMLE.html"><a href="10-TMLE.html#empirical-investigation"><i class="fa fa-check"></i><b>10.4.3</b> Empirical investigation</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="11-closing-words.html"><a href="11-closing-words.html"><i class="fa fa-check"></i><b>11</b> Closing words</a></li>
<li class="appendix"><span><b>Appendix</b></span></li>
<li class="chapter" data-level="A" data-path="A-notation.html"><a href="A-notation.html"><i class="fa fa-check"></i><b>A</b> Notation</a></li>
<li class="chapter" data-level="B" data-path="B-proofs.html"><a href="B-proofs.html"><i class="fa fa-check"></i><b>B</b> Basic results and their proofs</a>
<ul>
<li class="chapter" data-level="B.1" data-path="B-proofs.html"><a href="B-proofs.html#npsem"><i class="fa fa-check"></i><b>B.1</b> NPSEM</a></li>
<li class="chapter" data-level="B.2" data-path="B-proofs.html"><a href="B-proofs.html#identification"><i class="fa fa-check"></i><b>B.2</b> Identification</a></li>
<li class="chapter" data-level="B.3" data-path="B-proofs.html"><a href="B-proofs.html#confidence-interval"><i class="fa fa-check"></i><b>B.3</b> Building a confidence interval</a>
<ul>
<li class="chapter" data-level="B.3.1" data-path="B-proofs.html"><a href="B-proofs.html#clt"><i class="fa fa-check"></i><b>B.3.1</b> CLT &amp; Slutsky’s lemma</a></li>
<li class="chapter" data-level="B.3.2" data-path="B-proofs.html"><a href="B-proofs.html#order"><i class="fa fa-check"></i><b>B.3.2</b> CLT and order statistics</a></li>
</ul></li>
<li class="chapter" data-level="B.4" data-path="B-proofs.html"><a href="B-proofs.html#another-rep"><i class="fa fa-check"></i><b>B.4</b> Another representation of the parameter of interest</a></li>
<li class="chapter" data-level="B.5" data-path="B-proofs.html"><a href="B-proofs.html#prop-delta-method"><i class="fa fa-check"></i><b>B.5</b> The delta-method</a></li>
<li class="chapter" data-level="B.6" data-path="B-proofs.html"><a href="B-proofs.html#oracle-logistic-risk"><i class="fa fa-check"></i><b>B.6</b> The oracle logistic risk</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="C-more-proofs.html"><a href="C-more-proofs.html"><i class="fa fa-check"></i><b>C</b> More results and their proofs</a>
<ul>
<li class="chapter" data-level="C.1" data-path="C-more-proofs.html"><a href="C-more-proofs.html#estimation-of-the-asymptotic-variance-of-an-estimator"><i class="fa fa-check"></i><b>C.1</b> Estimation of the asymptotic variance of an estimator</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="C-more-proofs.html"><a href="C-more-proofs.html#iptw-est-var"><i class="fa fa-check"></i><b>C.1.1</b> IPTW estimator based on a well-specified model</a></li>
<li class="chapter" data-level="C.1.2" data-path="C-more-proofs.html"><a href="C-more-proofs.html#gcomp-est-var"><i class="fa fa-check"></i><b>C.1.2</b> G-computation estimator based on a well-specified model</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="C-more-proofs.html"><a href="C-more-proofs.html#app-analysis-of-plug-in"><i class="fa fa-check"></i><b>C.2</b> ☡  General analysis of plug-in estimators</a>
<ul>
<li class="chapter" data-level="C.2.1" data-path="C-more-proofs.html"><a href="C-more-proofs.html#app-analysis-of-plug-in-main"><i class="fa fa-check"></i><b>C.2.1</b> Main analysis</a></li>
<li class="chapter" data-level="C.2.2" data-path="C-more-proofs.html"><a href="C-more-proofs.html#estimation-of-the-asymptotic-variance"><i class="fa fa-check"></i><b>C.2.2</b> Estimation of the asymptotic variance</a></li>
</ul></li>
<li class="chapter" data-level="C.3" data-path="C-more-proofs.html"><a href="C-more-proofs.html#asymp-neglig-remain"><i class="fa fa-check"></i><b>C.3</b> Asymptotic negligibility of the remainder term</a></li>
<li class="chapter" data-level="C.4" data-path="C-more-proofs.html"><a href="C-more-proofs.html#analysis-TMLE"><i class="fa fa-check"></i><b>C.4</b> Analysis of targeted estimators</a>
<ul>
<li class="chapter" data-level="C.4.1" data-path="C-more-proofs.html"><a href="C-more-proofs.html#basic-eic-eq"><i class="fa fa-check"></i><b>C.4.1</b> A basic fact on the influence curve equation</a></li>
<li class="chapter" data-level="C.4.2" data-path="C-more-proofs.html"><a href="C-more-proofs.html#fluct-reg"><i class="fa fa-check"></i><b>C.4.2</b> Fluctuation of the regression function along the fluctuation of a law</a></li>
<li class="chapter" data-level="C.4.3" data-path="C-more-proofs.html"><a href="C-more-proofs.html#fluct-score"><i class="fa fa-check"></i><b>C.4.3</b> Computing the score of a fluctuation of the regression function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="D" data-path="D-references.html"><a href="D-references.html"><i class="fa fa-check"></i><b>D</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Ride in Targeted Learning Territory</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
\(\newcommand{\bbO}{\mathbb{O}}\)
\(\newcommand{\bbD}{\mathbb{D}}\)
\(\newcommand{\bbP}{\mathbb{P}}\)
\(\newcommand{\bbR}{\mathbb{R}}\)
\(\newcommand{\Algo}{\widehat{\mathcal{A}}}\)
\(\newcommand{\Algora}{\widetilde{\mathcal{A}}}\)
\(\newcommand{\calF}{\mathcal{F}}\)
\(\newcommand{\calM}{\mathcal{M}}\)
\(\newcommand{\calP}{\mathcal{P}}\)
\(\newcommand{\calO}{\mathcal{O}}\)
\(\newcommand{\calQ}{\mathcal{Q}}\)
\(\newcommand{\defq}{\doteq}\)
\(\newcommand{\Exp}{\textrm{E}}\)
\(\newcommand{\IC}{\textrm{IC}}\)
\(\newcommand{\Gbar}{\bar{G}}\)
\(\newcommand{\one}{\textbf{1}}\)
\(\newcommand{\psinos}{\psi_{n}^{\textrm{os}}}\)
\(\renewcommand{\Pr}{\textrm{Pr}}\)
\(\newcommand{\Phat}{P^{\circ}}\)
\(\newcommand{\Psihat}{\widehat{\Psi}}\)
\(\newcommand{\Qbar}{\bar{Q}}\)
\(\newcommand{\tcg}[1]{\textcolor{olive}{#1}}\)
\(\DeclareMathOperator{\Dirac}{Dirac}\)
\(\DeclareMathOperator{\expit}{expit}\)
\(\DeclareMathOperator{\logit}{logit}\)
\(\DeclareMathOperator{\Rem}{Rem}\)
\(\DeclareMathOperator{\Var}{Var}\)
<div id="simple-strategy" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Section 6</span> A simple inference strategy<a href="6-simple-strategy.html#simple-strategy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="a-cautionary-detour" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> A cautionary detour<a href="6-simple-strategy.html#a-cautionary-detour" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let us introduce first the following estimator:</p>
<p><span class="math display" id="eq:cautionary">\[\begin{align}
\notag \psi_{n}^{a}
&amp;\defq \frac{\Exp_{P_{n}} (AY)}{\Exp_{P_{n}} (A)} - \frac{\Exp_{P_{n}}
((1-A)Y)}{\Exp_{P_{n}}(1-A)} \\ 
&amp;=          \frac{\sum_{i=1}^{n}         \one\{A_{i}=Y_{i}=1\}}{\sum_{i=1}^{n}
\one\{A_{i}=1\}}                     -                    \frac{\sum_{i=1}^{n}
\one\{A_{i}=0,Y_{i}=1\}}{\sum_{i=1}^{n}\one\{A_{i}=0\}}. \tag{6.1} 
\end{align}\]</span></p>
<p>Note that <span class="math inline">\(\psi_n^a\)</span> is simply the difference in sample means between
observations with <span class="math inline">\(A = 1\)</span> and observations with <span class="math inline">\(A = 0\)</span>. It estimates
<span class="math display">\[\begin{align*}\Phi(P_{0}) &amp;\defq \frac{\Exp_{P_{0}}
(AY)}{\Exp_{P_{0}} (A)} - \frac{\Exp_{P_{0}} ((1-A)Y)}{\Exp_{P_{0}} (1-A)}\\&amp;=
\Exp_{P_{0}} (Y | A=1) - \Exp_{P_{0}} (Y | A=0).\end{align*}\]</span></p>
<p>We seize this opportunity to demonstrate numerically that
<span class="math inline">\(\psi_{n}^{a}\)</span> <em>does not</em> estimate <span class="math inline">\(\Psi(P_{0})\)</span> because, in general,
<span class="math inline">\(\Psi(P_{0})\)</span> and <span class="math inline">\(\Phi(P_{0})\)</span> differ. This is apparent in the following
alternative expression of <span class="math inline">\(\Phi(P_{0})\)</span>:</p>
<p><span class="math display">\[\begin{align*} \Phi(P_{0}) &amp;= \Exp_{P_{0}} \left(\Exp_{P_0}(Y \mid A, W) |A=1)
\right) -  \Exp_{P_{0}} \left(\Exp_{P_0}(Y \mid  A, W) | A=0\right)\\  &amp;= \int
\Qbar_{0}(1, w) dP_{0,W|A=1}(w) - \int \Qbar_{0}(0, w) dP_{0,W|A=0}(w).
\end{align*}\]</span></p>
<p>Contrast the above equalities and <a href="2-parameter.html#eq:psi-zero">(2.1)</a>. In the latter, the
outer integral is against the marginal law of <span class="math inline">\(W\)</span> under <span class="math inline">\(P_{0}\)</span>. In the
former, the outer integrals are respectively against the conditional laws of
<span class="math inline">\(W\)</span> given <span class="math inline">\(A=1\)</span> and <span class="math inline">\(A=0\)</span> under <span class="math inline">\(P_{0}\)</span>. Thus <span class="math inline">\(\Psi(P_0)\)</span> and <span class="math inline">\(\Phi(P_0)\)</span> will
enjoy equality when the conditional laws of <span class="math inline">\(W\)</span> given <span class="math inline">\(A = 1\)</span> and <span class="math inline">\(W\)</span> given
<span class="math inline">\(A = 0\)</span> both equal the marginal law of <span class="math inline">\(W\)</span>. This can sometimes be
ensured by design, as in an experiment where <span class="math inline">\(A\)</span> is randomly allocated to
observations, irrespective of <span class="math inline">\(W\)</span>. However, barring this level of experimental
control, in general the naive estimator may lead us astray in our goal of
drawing causal inference.</p>
</div>
<div id="delta-method" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> ⚙ Delta-method<a href="6-simple-strategy.html#delta-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consider the next chunk of code:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="6-simple-strategy.html#cb37-1" aria-hidden="true" tabindex="-1"></a>compute_irrelevant_estimator <span class="ot">&lt;-</span> <span class="cf">function</span>(obs) {</span>
<span id="cb37-2"><a href="6-simple-strategy.html#cb37-2" aria-hidden="true" tabindex="-1"></a>  obs <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(obs)</span>
<span id="cb37-3"><a href="6-simple-strategy.html#cb37-3" aria-hidden="true" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">pull</span>(obs, Y)</span>
<span id="cb37-4"><a href="6-simple-strategy.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">pull</span>(obs, A)</span>
<span id="cb37-5"><a href="6-simple-strategy.html#cb37-5" aria-hidden="true" tabindex="-1"></a>  psi_n <span class="ot">&lt;-</span> <span class="fu">mean</span>(A <span class="sc">*</span> Y) <span class="sc">/</span> <span class="fu">mean</span>(A) <span class="sc">-</span> <span class="fu">mean</span>((<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">*</span> Y) <span class="sc">/</span> <span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">-</span> A)</span>
<span id="cb37-6"><a href="6-simple-strategy.html#cb37-6" aria-hidden="true" tabindex="-1"></a>  Var_n <span class="ot">&lt;-</span> <span class="fu">cov</span>(<span class="fu">cbind</span>(A <span class="sc">*</span> Y, A, (<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">*</span> Y, (<span class="dv">1</span> <span class="sc">-</span> A)))</span>
<span id="cb37-7"><a href="6-simple-strategy.html#cb37-7" aria-hidden="true" tabindex="-1"></a>  phi_n <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(A), <span class="sc">-</span><span class="fu">mean</span>(A <span class="sc">*</span> Y) <span class="sc">/</span> <span class="fu">mean</span>(A)<span class="sc">^</span><span class="dv">2</span>,</span>
<span id="cb37-8"><a href="6-simple-strategy.html#cb37-8" aria-hidden="true" tabindex="-1"></a>             <span class="sc">-</span><span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">-</span> A),</span>
<span id="cb37-9"><a href="6-simple-strategy.html#cb37-9" aria-hidden="true" tabindex="-1"></a>             <span class="fu">mean</span>((<span class="dv">1</span> <span class="sc">-</span> A) <span class="sc">*</span> Y) <span class="sc">/</span> <span class="fu">mean</span>(<span class="dv">1</span> <span class="sc">-</span> A)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb37-10"><a href="6-simple-strategy.html#cb37-10" aria-hidden="true" tabindex="-1"></a>  var_n <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">t</span>(phi_n) <span class="sc">%*%</span> Var_n <span class="sc">%*%</span> phi_n)</span>
<span id="cb37-11"><a href="6-simple-strategy.html#cb37-11" aria-hidden="true" tabindex="-1"></a>  sig_n <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_n <span class="sc">/</span> <span class="fu">nrow</span>(obs))</span>
<span id="cb37-12"><a href="6-simple-strategy.html#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">psi_n =</span> psi_n, <span class="at">sig_n =</span> sig_n)</span>
<span id="cb37-13"><a href="6-simple-strategy.html#cb37-13" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Function <code>compute_irrelevant_estimator</code> computes the estimator <span class="math inline">\(\psi_{n}^{a}\)</span>
<a href="6-simple-strategy.html#eq:cautionary">(6.1)</a> based on the data set in <code>obs</code>.</p>
<p>Introduce <span class="math inline">\(X_{n} \defq n^{-1}\sum_{i=1}^{n} \left(A_{i}Y_{i}, A_{i}, (1-A_{i})Y_{i}, 1-A_{i}\right)^{\top}\)</span> and <span class="math inline">\(X \defq \left(AY, A, (1-A)Y, 1-A\right)^{\top}\)</span>. It happens that <span class="math inline">\(X_{n}\)</span> is asymptotically Gaussian: as
<span class="math inline">\(n\)</span> goes to infinity,<span class="math display">\[\begin{equation*}\sqrt{n} \left(X_{n}  -  \Exp_{P_{0}}
(X)\right)\end{equation*}\]</span> converges in law to the centered Gaussian law with
covariance matrix <span class="math display">\[\begin{equation*}V_{0} \defq \Exp_{P_{0}} \left((X
- \Exp_{P_{0}} (X)) \times (X- \Exp_{P_{0}} (X))^{\top}\right).\end{equation*}\]</span></p>
<p>Let <span class="math inline">\(f:\bbR\times \bbR^{*} \times \bbR\times \bbR^{*}\)</span> be given by <span class="math inline">\(f(r,s,t,u) = r/s - t/u\)</span>. The function is differentiable.</p>
<ol style="list-style-type: decimal">
<li><p>Check that <span class="math inline">\(\psi_{n}^{a} = f(X_{n})\)</span>. Point out the line where
<span class="math inline">\(\psi_{n}^{a}\)</span> is computed in the body of <code>compute_irrelevant_estimator</code>.
Also point out to the line where the above asymptotic variance of <span class="math inline">\(X_{n}\)</span>
is estimated with its empirical counterpart, say <span class="math inline">\(V_{n}\)</span>.</p></li>
<li><p>☡  Argue how the <a href="B-proofs.html#prop-delta-method">delta-method</a>
yields that <span class="math inline">\(\sqrt{n}(\psi_{n}^{a} - \Phi(P_{0}))\)</span> converges in law to the
centered Gaussian law with a variance that can be estimated with
<span class="math display" id="eq:v-n-a">\[\begin{equation}  v_{n}^{a}  \defq  \nabla f(X_{n})  \times  V_{n}  \times
\nabla f(X_{n})^{\top}. \tag{6.2} \end{equation}\]</span></p></li>
<li><p>Check that the gradient <span class="math inline">\(\nabla f\)</span> of <span class="math inline">\(f\)</span> is given by <span class="math inline">\(\nabla f(r,s,t,u) \defq (1/s, -r/s^{2}, -1/u, t/u^{2})\)</span>. Point out to the line where the
asymptotic variance of <span class="math inline">\(\psi_{n}^{a}\)</span> is estimated.</p></li>
</ol>
<p>For instance,</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="6-simple-strategy.html#cb38-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">compute_irrelevant_estimator</span>(<span class="fu">head</span>(obs, <span class="fl">1e3</span>)))</span>
<span id="cb38-2"><a href="6-simple-strategy.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb38-3"><a href="6-simple-strategy.html#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   psi_n  sig_n</span></span>
<span id="cb38-4"><a href="6-simple-strategy.html#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb38-5"><a href="6-simple-strategy.html#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.126 0.0181</span></span></code></pre></div>
<p>computes the numerical values of <span class="math inline">\(\psi_{n}^{a}\)</span> and <span class="math inline">\(v_{n}^{a}\)</span> based on the
1000 first observations in <code>obs</code>.</p>
</div>
<div id="known-gbar-first-pass" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> IPTW estimator assuming the mechanism of action known<a href="6-simple-strategy.html#known-gbar-first-pass" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="a-simple-estimator" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> A simple estimator<a href="6-simple-strategy.html#a-simple-estimator" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let us assume for a moment that we know <span class="math inline">\(\Gbar_{0}\)</span>. This would have been the
case indeed if we had experimental control over the actions taken by observational units, as in a randomized experiment. Note that, on the
contrary, assuming <span class="math inline">\(\Qbar_{0}\)</span> known would be difficult to justify.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="6-simple-strategy.html#cb39-1" aria-hidden="true" tabindex="-1"></a>Gbar <span class="ot">&lt;-</span> <span class="fu">get_feature</span>(experiment, <span class="st">&quot;Gbar&quot;</span>)</span></code></pre></div>
<p>The alternative expression <a href="2-parameter.html#eq:psi-zero-b">(2.7)</a> suggests to estimate
<span class="math inline">\(\Psi(P_{0})\)</span> with</p>
<p><span class="math display" id="eq:psi-n-b">\[\begin{align}
\psi_{n}^{b}  &amp;\defq \Exp_{P_{n}}  \left( \frac{2A-1}{\ell  \Gbar_{0}(A,W)} Y
\right) \\ 
&amp;       =        \frac{1}{n}       \sum_{i=1}^{n}       \left(\frac{2A_{i}-1}{
\ell\Gbar_{0}(A_{i},W_{i})}Y_{i} \right). \tag{6.3}
\end{align}\]</span></p>
<p>Note how <span class="math inline">\(P_{n}\)</span> is substituted for <span class="math inline">\(P_{0}\)</span> in <a href="6-simple-strategy.html#eq:psi-n-b">(6.3)</a> relative to
<a href="2-parameter.html#eq:psi-zero-b">(2.7)</a>. However, we cannot call <span class="math inline">\(\psi_{n}^{b}\)</span> a <em>substitution
estimator</em> because it does not write as <span class="math inline">\(\Psi\)</span> evaluated at an element of
<span class="math inline">\(\calM\)</span>. This said, it is dubbed an IPTW (inverse probability of treatment
weighted) estimator because of the denominators <span class="math inline">\(\ell\Gbar_{0}(A_{i},W_{i})\)</span>
in its definition.<a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a></p>
<p>In Section <a href="8-naive-estimators.html#known-gbar-second-pass">8.2</a>, we develop another IPTW estimator
that does not assume that <span class="math inline">\(\Gbar_{0}\)</span> is known beforehand.</p>
</div>
<div id="elementary-statistical-properties" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Elementary statistical properties<a href="6-simple-strategy.html#elementary-statistical-properties" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>It is easy to check that <span class="math inline">\(\psi_{n}^{b}\)</span> estimates <span class="math inline">\(\Psi(P_{0})\)</span> consistently,
but this is too little to request from an estimator of <span class="math inline">\(\psi_{0}\)</span>. Better,
<span class="math inline">\(\psi_{n}^{b}\)</span> also satisfies a central limit theorem: <span class="math inline">\(\sqrt{n} (\psi_{n}^{b} - \psi_{0})\)</span> converges in law to a centered Gaussian law with
asymptotic variance <span class="math display">\[\begin{equation*}v^{b}     \defq     \Var_{P_{0}}
\left(\frac{2A-1}{\ell\Gbar_{0}(A,W)}Y\right),\end{equation*}\]</span> where <span class="math inline">\(v^{b}\)</span>
can be consistently estimated by its empirical counterpart</p>
<p><span class="math display" id="eq:v-n-b">\[\begin{align}
\tag{6.4}      v_{n}^{b}       &amp;\defq      \Var_{P_{n}}
\left(\frac{2A-1}{\ell\Gbar_{0}(A,W)}Y\right) \\ 
&amp;=        \frac{1}{n}        \sum_{i=1}^{n}\left(\frac{2A_{i}-1}{\ell\Gbar_{0}
(A_{i},W_{i})} Y_{i} - \psi_{n}^{b}\right)^{2}.
\end{align}\]</span></p>
<p>We investigate <em>empirically</em> the statistical behavior of <span class="math inline">\(\psi_{n}^{b}\)</span> in
Section <a href="6-simple-strategy.html#empirical-inves-IPTW">6.3.3</a>.</p>
</div>
<div id="empirical-inves-IPTW" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Empirical investigation<a href="6-simple-strategy.html#empirical-inves-IPTW" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The package <code>tlrider</code> includes <code>compute_iptw</code>, a function that implements the
IPTW inference strategy (simply run <code>?compute_iptw</code> to see its man page). For
instance,</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="6-simple-strategy.html#cb40-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">compute_iptw</span>(<span class="fu">head</span>(obs, <span class="fl">1e3</span>), Gbar))</span>
<span id="cb40-2"><a href="6-simple-strategy.html#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb40-3"><a href="6-simple-strategy.html#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   psi_n  sig_n</span></span>
<span id="cb40-4"><a href="6-simple-strategy.html#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb40-5"><a href="6-simple-strategy.html#cb40-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.167 0.0533</span></span></code></pre></div>
<p>computes the numerical values of <span class="math inline">\(\psi_{n}^{b}\)</span> and <span class="math inline">\(v_{n}^{b}\)</span> based
upon the 1000 first observations contained in <code>obs</code>.</p>
<p>The next chunk of code investigates the empirical behaviors of estimators
<span class="math inline">\(\psi_{n}^{a}\)</span> and <span class="math inline">\(\psi_{n}^{b}\)</span>. As explained in Section <a href="5-inference.html#inference">5</a>,
we first make 1000 data sets out of the <code>obs</code> data set (second line), then
build the estimators on each of them (fourth and fifth lines). After the first
series of commands the object <code>psi_hat_ab</code>, a <code>tibble</code>, contains 2000
rows and four columns. For each smaller data set (identified by its <code>id</code>),
two rows contain the values of either <span class="math inline">\(\psi_{n}^{a}\)</span> and
<span class="math inline">\(\sqrt{v_{n}^{a}}/\sqrt{n}\)</span> (if <code>type</code> equals <code>a</code>) or <span class="math inline">\(\psi_{n}^{b}\)</span> and
<span class="math inline">\(\sqrt{v_{n}^{b}}/\sqrt{n}\)</span> (if <code>type</code> equals <code>b</code>).</p>
<p>After the second series of commands, the object <code>psi_hat_ab</code> contains, in
addition, the values of the recentered (with respect to <span class="math inline">\(\psi_{0}\)</span>) and
renormalized <span class="math inline">\(\sqrt{n}/\sqrt{v_{n}^{a}} (\psi_{n}^{a} - \psi_{0})\)</span> and
<span class="math inline">\(\sqrt{n}/\sqrt{v_{n}^{b}} (\psi_{n}^{b} - \psi_{0})\)</span>, where <span class="math inline">\(v_{n}^{a}\)</span>
<a href="6-simple-strategy.html#eq:v-n-a">(6.2)</a> and <span class="math inline">\(v_{n}^{b}\)</span> <a href="6-simple-strategy.html#eq:v-n-b">(6.4)</a> estimate the asymptotic
variances of <span class="math inline">\(\psi_{n}^{a}\)</span> and <span class="math inline">\(\psi_{n}^{b}\)</span>, respectively. Finally,
<code>bias_ab</code> reports amounts of bias (at the renormalized scale).</p>
<p>We will refer to the recentering (always with respect to <span class="math inline">\(\psi_{0}\)</span>) then
renormalizing procedure as a <em>renormalization scheme</em>, because what may vary
between two such procedures is the renormalization factor. We will judge
whether or not the renormalization scheme is adequate for instance by
comparing kernel density estimators of the law of estimators gone through a
renormalization procedure with the standard normal density, as in Figure
<a href="6-simple-strategy.html#fig:known-Gbar-one-b">6.1</a> below.</p>

<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="6-simple-strategy.html#cb41-1" aria-hidden="true" tabindex="-1"></a>psi_hat_ab <span class="ot">&lt;-</span> obs <span class="sc">%&gt;%</span> as_tibble  <span class="sc">%&gt;%</span></span>
<span id="cb41-2"><a href="6-simple-strategy.html#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">id =</span> (<span class="fu">seq_len</span>(<span class="fu">n</span>()) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">%%</span> iter) <span class="sc">%&gt;%</span></span>
<span id="cb41-3"><a href="6-simple-strategy.html#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">nest</span>(<span class="at">obs =</span> <span class="fu">c</span>(W, A, Y)) <span class="sc">%&gt;%</span></span>
<span id="cb41-4"><a href="6-simple-strategy.html#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">est_a =</span> <span class="fu">map</span>(obs, <span class="sc">~</span> <span class="fu">compute_irrelevant_estimator</span>(.)),</span>
<span id="cb41-5"><a href="6-simple-strategy.html#cb41-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">est_b =</span> <span class="fu">map</span>(obs, <span class="sc">~</span> <span class="fu">compute_iptw</span>(<span class="fu">as.matrix</span>(.), Gbar))) <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="6-simple-strategy.html#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="fu">c</span>(<span class="st">`</span><span class="at">est_a</span><span class="st">`</span>, <span class="st">`</span><span class="at">est_b</span><span class="st">`</span>),</span>
<span id="cb41-7"><a href="6-simple-strategy.html#cb41-7" aria-hidden="true" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&quot;type&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;estimates&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-8"><a href="6-simple-strategy.html#cb41-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract</span>(type, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;_([ab])$&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb41-9"><a href="6-simple-strategy.html#cb41-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(estimates) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>obs)</span>
<span id="cb41-10"><a href="6-simple-strategy.html#cb41-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-11"><a href="6-simple-strategy.html#cb41-11" aria-hidden="true" tabindex="-1"></a>(psi_hat_ab)</span>
<span id="cb41-12"><a href="6-simple-strategy.html#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2,000 × 4</span></span>
<span id="cb41-13"><a href="6-simple-strategy.html#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      id type   psi_n  sig_n</span></span>
<span id="cb41-14"><a href="6-simple-strategy.html#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb41-15"><a href="6-simple-strategy.html#cb41-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     0 a     0.140  0.0174</span></span>
<span id="cb41-16"><a href="6-simple-strategy.html#cb41-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     0 b     0.0772 0.0546</span></span>
<span id="cb41-17"><a href="6-simple-strategy.html#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     1 a     0.107  0.0169</span></span>
<span id="cb41-18"><a href="6-simple-strategy.html#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     1 b     0.138  0.0541</span></span>
<span id="cb41-19"><a href="6-simple-strategy.html#cb41-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     2 a     0.107  0.0172</span></span>
<span id="cb41-20"><a href="6-simple-strategy.html#cb41-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     2 b     0.0744 0.0553</span></span>
<span id="cb41-21"><a href="6-simple-strategy.html#cb41-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1,994 more rows</span></span>
<span id="cb41-22"><a href="6-simple-strategy.html#cb41-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-23"><a href="6-simple-strategy.html#cb41-23" aria-hidden="true" tabindex="-1"></a>psi_hat_ab <span class="ot">&lt;-</span> psi_hat_ab <span class="sc">%&gt;%</span> </span>
<span id="cb41-24"><a href="6-simple-strategy.html#cb41-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(id) <span class="sc">%&gt;%</span></span>
<span id="cb41-25"><a href="6-simple-strategy.html#cb41-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">clt =</span> (psi_n <span class="sc">-</span> psi_zero) <span class="sc">/</span> sig_n)</span>
<span id="cb41-26"><a href="6-simple-strategy.html#cb41-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-27"><a href="6-simple-strategy.html#cb41-27" aria-hidden="true" tabindex="-1"></a>(psi_hat_ab)</span>
<span id="cb41-28"><a href="6-simple-strategy.html#cb41-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2,000 × 5</span></span>
<span id="cb41-29"><a href="6-simple-strategy.html#cb41-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # Groups:   id [1,000]</span></span>
<span id="cb41-30"><a href="6-simple-strategy.html#cb41-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      id type   psi_n  sig_n    clt</span></span>
<span id="cb41-31"><a href="6-simple-strategy.html#cb41-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb41-32"><a href="6-simple-strategy.html#cb41-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1     0 a     0.140  0.0174  3.23 </span></span>
<span id="cb41-33"><a href="6-simple-strategy.html#cb41-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2     0 b     0.0772 0.0546 -0.109</span></span>
<span id="cb41-34"><a href="6-simple-strategy.html#cb41-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3     1 a     0.107  0.0169  1.40 </span></span>
<span id="cb41-35"><a href="6-simple-strategy.html#cb41-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 4     1 b     0.138  0.0541  1.01 </span></span>
<span id="cb41-36"><a href="6-simple-strategy.html#cb41-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 5     2 a     0.107  0.0172  1.38 </span></span>
<span id="cb41-37"><a href="6-simple-strategy.html#cb41-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 6     2 b     0.0744 0.0553 -0.159</span></span>
<span id="cb41-38"><a href="6-simple-strategy.html#cb41-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # … with 1,994 more rows</span></span>
<span id="cb41-39"><a href="6-simple-strategy.html#cb41-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-40"><a href="6-simple-strategy.html#cb41-40" aria-hidden="true" tabindex="-1"></a>(bias_ab <span class="ot">&lt;-</span> psi_hat_ab <span class="sc">%&gt;%</span></span>
<span id="cb41-41"><a href="6-simple-strategy.html#cb41-41" aria-hidden="true" tabindex="-1"></a>   <span class="fu">group_by</span>(type) <span class="sc">%&gt;%</span> <span class="fu">summarize</span>(<span class="at">bias =</span> <span class="fu">mean</span>(clt), <span class="at">.groups =</span> <span class="st">&quot;drop&quot;</span>))</span>
<span id="cb41-42"><a href="6-simple-strategy.html#cb41-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; # A tibble: 2 × 2</span></span>
<span id="cb41-43"><a href="6-simple-strategy.html#cb41-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   type    bias</span></span>
<span id="cb41-44"><a href="6-simple-strategy.html#cb41-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;  &lt;dbl&gt;</span></span>
<span id="cb41-45"><a href="6-simple-strategy.html#cb41-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 a     1.39  </span></span>
<span id="cb41-46"><a href="6-simple-strategy.html#cb41-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 b     0.0241</span></span>
<span id="cb41-47"><a href="6-simple-strategy.html#cb41-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-48"><a href="6-simple-strategy.html#cb41-48" aria-hidden="true" tabindex="-1"></a>fig_bias_ab <span class="ot">&lt;-</span> <span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb41-49"><a href="6-simple-strategy.html#cb41-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y), </span>
<span id="cb41-50"><a href="6-simple-strategy.html#cb41-50" aria-hidden="true" tabindex="-1"></a>            <span class="at">data =</span> <span class="fu">tibble</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="fl">1e3</span>),</span>
<span id="cb41-51"><a href="6-simple-strategy.html#cb41-51" aria-hidden="true" tabindex="-1"></a>                          <span class="at">y =</span> <span class="fu">dnorm</span>(x)),</span>
<span id="cb41-52"><a href="6-simple-strategy.html#cb41-52" aria-hidden="true" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb41-53"><a href="6-simple-strategy.html#cb41-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="fu">aes</span>(clt, <span class="at">fill =</span> type, <span class="at">colour =</span> type),</span>
<span id="cb41-54"><a href="6-simple-strategy.html#cb41-54" aria-hidden="true" tabindex="-1"></a>               psi_hat_ab, <span class="at">alpha =</span> <span class="fl">0.1</span>) <span class="sc">+</span></span>
<span id="cb41-55"><a href="6-simple-strategy.html#cb41-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> bias, <span class="at">colour =</span> type),</span>
<span id="cb41-56"><a href="6-simple-strategy.html#cb41-56" aria-hidden="true" tabindex="-1"></a>             bias_ab, <span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb41-57"><a href="6-simple-strategy.html#cb41-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb41-58"><a href="6-simple-strategy.html#cb41-58" aria-hidden="true" tabindex="-1"></a>fig_bias_ab <span class="sc">+</span></span>
<span id="cb41-59"><a href="6-simple-strategy.html#cb41-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-60"><a href="6-simple-strategy.html#cb41-60" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(<span class="fu">sqrt</span>(n<span class="sc">/</span>v[n]<span class="sc">^</span>{<span class="fu">list</span>(a, b)})<span class="sc">*</span></span>
<span id="cb41-61"><a href="6-simple-strategy.html#cb41-61" aria-hidden="true" tabindex="-1"></a>                        (psi[n]<span class="sc">^</span>{<span class="fu">list</span>(a, b)} <span class="sc">-</span> psi[<span class="dv">0</span>]))))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:known-Gbar-one-b"></span>
<img src="img/known-Gbar-one-b-1.png" alt="Kernel density estimators of the law of two estimators of \(\psi_{0}\) (recentered with respect to \(\psi_{0}\), and renormalized), one of them misconceived (a), the other assuming that \(\Gbar_{0}\) is known (b). Built based on 1000 independent realizations of each estimator." width="70%" />
<p class="caption">
Figure 6.1: Kernel density estimators of the law of two estimators of <span class="math inline">\(\psi_{0}\)</span> (recentered with respect to <span class="math inline">\(\psi_{0}\)</span>, and renormalized), one of them misconceived (a), the other assuming that <span class="math inline">\(\Gbar_{0}\)</span> is known (b). Built based on 1000 independent realizations of each estimator.
</p>
</div>
<p>By the above chunk of code, the averages of <span class="math inline">\(\sqrt{n/v_{n}^{a}} (\psi_{n}^{a} - \psi_{0})\)</span> and <span class="math inline">\(\sqrt{n/v_{n}^{b}} (\psi_{n}^{b} - \psi_{0})\)</span>
computed across the realizations of the two estimators are respectively equal
to 1.387 and
0.024 (see <code>bias_ab</code>). Interpreted as amounts of bias, those two
quantities are represented by vertical lines in Figure
<a href="6-simple-strategy.html#fig:known-Gbar-one-b">6.1</a>. The red and blue bell-shaped curves represent the
empirical laws of <span class="math inline">\(\psi_{n}^{a}\)</span> and <span class="math inline">\(\psi_{n}^{b}\)</span> (recentered with respect
to <span class="math inline">\(\psi_{0}\)</span>, and renormalized) as estimated by kernel density estimation.
The latter is close to the black curve, which represents the standard normal
density.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="10">
<li id="fn10"><p>We could have used the alternative expression IPAW, where
A (like action) is substituted for T (like treatment).<a href="6-simple-strategy.html#fnref10" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="5-inference.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="7-nuisance.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["tlride-book.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_hightlight": true,
"toolbar": {
"position": "static"
},
"edit": null,
"download": "pdf",
"search": true,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
}
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
